# ADR-004: Unified Monorepo and IaC Strategy

**Status:** Accepted

**Date:** February 21, 2026

## 1. Context
Managing the Next.js frontend, the AWS Lambda orchestrator, and the CDK infrastructure in separate repositories creates friction, synchronization errors during deployment, and prevents the sharing of TypeScript types.

## 2. Decision
Adopt a **Unified Monorepo** managed by **Turborepo**, utilizing **AWS CDK** as the sole Infrastructure as Code (IaC) tool.

## 3. Rationale
* **Atomic Deployments:** Infrastructure and application code are versioned together. A single `git push` ensures that the Lambda logic and its IAM permissions are deployed in sync.
* **Full-Stack Type Safety:** Shared Zod schemas and TypeScript interfaces can be utilized across the frontend (**TanStack Query v5**) and the backend, eliminating runtime integration errors.
* **Developer Velocity:** A single toolchain for linting, testing, and building across the whole stack optimizes the local developer experience (DX).

## 4. Alternatives Considered
* **Terraform:** Rejected. While powerful for multi-cloud, it lacks the deep TypeScript integration and "high-level constructs" provided by AWS CDK for serverless applications.

## 5. Consequences
* **Positive:** Guaranteed synchronization between infrastructure and code; high confidence in full-stack type safety.
* **Negative:** Initial monorepo configuration is more complex than a standard single-repo setup.
