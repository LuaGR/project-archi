# ADR-005: Testing Strategy (TDD)

**Status:** Accepted

**Date:** February 21, 2026

## 1. Context
AI-driven systems are non-deterministic. To achieve enterprise-grade engineering quality, we must ensure that the orchestration logic is fully verified through automated tests before reaching production.

## 2. Decision
Standardize on **Vitest** for a strict **Red-Green-Refactor (TDD)** cycle, supported by **Playwright** for E2E (End-to-End) validation.

## 3. Rationale
* **Feedback Velocity:** Vitest provides near-instant execution, which is critical for maintaining developer flow during the TDD process.
* **AI Output Validation (Golden Sets):** We will implement "Golden Set" tests to verify that generated **Mermaid.js** code is syntactically correct and does not degrade with new model releases.
* **Cost Efficiency:** Using the Hexagonal Architecture (ADR-003), we will test logic using mocks, avoiding any Gemini API costs during the development phase.
 * **The 100/80/0 Rule:** We adopt a pragmatic coverage strategy:
   - **100% Domain:** All critical business logic, schemas, and exceptions must be fully tested.
   - **80% Application:** Core functionalities and orchestration flows must be tested.
   - **0% Infrastructure:** We do not write unit tests for adapters or CDK constructs, relying instead on E2E tests to validate external integrations.

## 4. Alternatives Considered
* **Manual Testing:** Rejected. Too slow and prone to human error for a professional architecture project.

## 5. Consequences
* **Positive:** High deployment confidence and "living documentation" provided by the test suite.
* **Negative:** Initial development is slightly slower as tests must be written alongside the production code.
